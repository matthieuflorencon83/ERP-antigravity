{% for besoin in besoins %}
<tr>
    <td class="text-nowrap font-monospace text-muted small">{{ besoin.article.ref_fournisseur|default:"-" }}</td>
    <td>
        <div class="fw-bold text-dark">{{ besoin.article.designation }}</div>
        {% if besoin.notes %}
        <div class="small text-muted fst-italic"><i class="bi bi-chat-left-text me-1"></i>{{ besoin.notes }}</div>
        {% endif %}
    </td>
    <td>
        {% if besoin.article.fournisseur %}
        <span class="badge bg-light text-dark border">{{ besoin.article.fournisseur.nom_fournisseur }}</span>
        {% else %}
        <span class="text-muted small">-</span>
        {% endif %}
    </td>
    <td class="text-center fw-bold">{{ besoin.quantite|floatformat:1 }}</td>
    <td class="text-center small text-muted text-uppercase">{{ besoin.unite }}</td>
    <td class="text-center">
        {% if besoin.ral %}
        <span class="badge rounded-pill text-bg-secondary">{{ besoin.ral }}</span>
        {% else %}
        <span class="text-muted small">-</span>
        {% endif %}
    </td>
    <td class="text-center">
        {% if besoin.statut == 'A_TRAITER' %}
        <span class="badge bg-warning text-dark"><i class="bi bi-hourglass me-1"></i>À traiter</span>
        {% elif besoin.statut == 'VALIDE' %}
        <span class="badge bg-success"><i class="bi bi-check-lg me-1"></i>Validé</span>
        {% elif besoin.statut == 'COMMANDE' %}
        <span class="badge bg-primary"><i class="bi bi-cart-check me-1"></i>Commandé</span>
        {% endif %}
    </td>
    <td class="text-end">
        <button class="btn btn-sm btn-action-icon text-danger" title="Supprimer">
            <i class="bi bi-trash"></i>
        </button>
    </td>
</tr>
{% empty %}
<tr>
    <td colspan="8" class="text-center py-5 text-muted">
        <div class="mb-2"><i class="bi bi-basket2 display-6 opacity-25"></i></div>
        Aucun besoin enregistré pour cette affaire.<br>
        Commencez par ajouter des articles ci-dessus.
    </td>
</tr>
{% endfor %}