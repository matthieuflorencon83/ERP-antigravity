<div class="table-responsive">
    <table class="table table-hover align-middle mb-0">
        <thead class="bg-light sticky-top">
            <tr>
                <th class="ps-4">
                    N° Commande
                </th>
                <th>
                    Fournisseur
                </th>
                <th>
                    Affaire
                </th>
                <th>
                    Date
                </th>
                <th>
                    Montant HT
                </th>
                {% if mode == 'livraison' %}
                    <th>
                        Date Prévue
                    </th>
                {% endif %}
                <th class="text-end pe-4">
                    Statut
                </th>
            </tr>
        </thead>
        <tbody>
            {% for c in commandes %}
                <!-- Row Clickable -> Detail -->
                <tr class="cursor-pointer position-relative
                           {% if c.is_late %}
                               table-danger
                           {% endif %}"
                    onclick="window.location.href='{% url 'commande_edit' c.id %}';">
                    <td class="ps-4 fw-bold text-primary">
                        {{ c.numero_bdc|default:c.id|truncatechars:8 }}
                    </td>
                    <td>
                        <div class="fw-bold">
                            {{ c.fournisseur.nom_fournisseur }}
                        </div>
                        {% if c.ref_externe_web %}
                            <small class="text-muted"><i class="bi bi-globe me-1"></i>{{ c.ref_externe_web }}</small>
                        {% endif %}
                    </td>
                    <td>
                        <span class="badge bg-secondary-subtle text-secondary border border-secondary-subtle">
                            {{ c.affaire.nom_affaire|truncatechars:20 }}
                        </span>
                    </td>
                    <td>
                        {% if mode == 'brouillon' %}
                            Créée le {{ c.date_creation|date:"d/m/Y" }}
                        {% elif mode == 'arc' %}
                            Envoyée le {{ c.date_commande|date:"d/m/Y" }}
                        {% elif mode == 'livraison' %}
                            ARC du {{ c.date_arc|date:"d/m/Y" }}
                        {% else %}
                            {{ c.date_creation|date:"d/m/Y" }}
                        {% endif %}
                    </td>
                    <td class="fw-bold text-dark">
                        {{ c.total_ht|floatformat:2 }} €
                    </td>
                    {% if mode == 'livraison' %}
                        <td>
                            {% if c.date_livraison_prevue %}
                                {% if c.is_late %}
                                    <span class="text-danger fw-bold"><i class="bi bi-exclamation-triangle me-1"></i>{{
                                    c.date_livraison_prevue|date:"d/m/Y" }}</span>
                                {% else %}
                                    <span class="text-success">{{ c.date_livraison_prevue|date:"d/m/Y" }}</span>
                                {% endif %}
                            {% else %}
                                <span class="text-muted">-</span>
                            {% endif %}
                        </td>
                    {% endif %}
                    <td class="text-end pe-4">
                        {% if c.statut == 'BROUILLON' %}
                            <span class="badge bg-warning text-dark">Brouillon</span>
                        {% elif c.statut == 'ENVOYEE' %}
                            <span class="badge bg-primary">Envoyée</span>
                        {% elif c.statut == 'CONFIRME_ARC' %}
                            <span class="badge bg-info text-dark">ARC Reçu</span>
                        {% elif c.statut == 'LIVREE' %}
                            <span class="badge bg-success">Livrée</span>
                        {% endif %}
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="8" class="text-center py-5 text-muted">
                        <i class="bi bi-inbox display-6 opacity-25"></i>
                        <p class="mt-2 text-uppercase fs-075 fw-bold letter-spacing-1">
                            Aucune commande dans cette catégorie
                        </p>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
